<ui:composition
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"
        xmlns:f="http://java.sun.com/jsf/core"
        template="baseTemplate.xhtml"
        >

    <ui:define name="head">
    </ui:define>

    <ui:define name="content">
        <h1>asdasdasd 222331</h1>

        <!--<div id="imagecropper" class="imagecropper"></div>-->
        <canvas id="canvas"></canvas>


        <!--hidden form to execute remote commands-->
        <h:form prependId="false" style="visibility: hidden">
            <p:remoteCommand name="createNewAnnotationBridge" actionListener="#{annotator.createNewAnnotation}"
                             update="@none" process="@this"
                             oncomplete="onAnnotationCreateComplete(xhr,status,args);"/>
        </h:form>

    </ui:define>

    <ui:define name="script">
        <script src="resources/annotate.js"></script>

        <script>
            var annotations = [
                {
                    id : 'asdasdasd',
                    'x': 10,
                    'y': 20,
                    'w': 100,
                    'h': 200,
                    'textData': {
                        'tr_latin': 'Kolay',
                        'tr_arabic': ' الف'
                    }
                }
            ];

            function createNewAnnotation(x, y, w, h, textData) {
                // sample text data:
                //{
                //    'tr_latin' : 'Kolay',
                //    'tr_arabic' : ' الف'
                //}
                createNewAnnotationBridge([
                    {name: 'x', value: x},
                    {name: 'y', value: y},
                    {name: 'w', value: w},
                    {name: 'h', value: h},
                    {name: 'tr_latin', value: textData.tr_latin},
                    {name: 'tr_arabic', value: textData.tr_arabic}
                ]);
            }

            function updateAnotation(annotationId, textData) {
                console.log(annotationId);
                console.log(textData)
            }

            function deleteAnnotation(annotationId) {
                console.log(annotationId);
            }

            function onAnnotationCreateComplete(xhr,status,args){
                if(args.annotationId){
                    console.log(args.annotationId);
                    annotator.addAnnotationFromCurrentOne(args.annotationId);
                }else{
                    alert('Creation failed');
                }
            }


            $(document).ready(function () {
                window['annotator'] = new Annotator({
                    'canvasId': 'canvas',
                    'imageSource': 'http://www.html5canvastutorials.com/demos/assets/darth-vader.jpg',
                    'onAnnotationCreate': createNewAnnotation,
                    'onAnnotationUpdate': updateAnotation,
                    'onAnnotationDelete': deleteAnnotation,
                    'annotations': annotations
                });

            });
        </script>
    </ui:define>

</ui:composition>